<!DOCTYPE >
<HTML>
<HEAD>
    <TITLE> 产品管理 </TITLE>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/main.css">
    <script src="/js/jquery.min.js"></script>
    <script src="/js/popper.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/sweetalert.min.js"></script>
    <script src="/js/jquery.form.js"></script>
    <script src="/js/layer/layer.js"></script>
    <script src="/js/main.js"></script>
    <script src="/js/getRequestParameters.js"></script>
</HEAD>
<BODY>

<script>
    function editPackage() {
        $("#searchForm").ajaxSubmit(function (data) {
            console.log(data);
            alert(data.data.message);
            if(data.data.state === "000000"){
                window.open("/view/EbizPackage/list.html" ,"_self");
            }else{
                location.reload();
            }
        });
        return false;
    }


    function changeToHome() {
        $("input[name=address]").val($("#home").text())
    }

    function changeToAddress1() {
        $("input[name=address]").val($("#address2").next()[0].innerText)
    }

    function changeToAddress2() {
        $("input[name=address]").val($("#address3").next()[0].innerText)
    }


    function changeToAddress3() {
        $("input[name=address]").val($("#address4").next()[0].innerText)
    }
</script>

<div class="container-fluid">
    <h3>修改包裹(Update Package)</h3>
    <form class="container-fluid form-inline" action="/package/edit" method="post" onsubmit="return editPackage();" id="searchForm">
        <div class="form-group">
            <label for="id">Package UID:</label>
            <input type="text" class="form-control mx-2 mt-2 mt-2" id="id" name="id" readonly>
        </div>
        <div class="form-group">
            <label for="modelNumber">型号:</label>
            <input type="text" class="form-control mx-2 mt-2" id="modelNumber" name="modelNumber">
        </div>
        <div class="form-group">
            <label for="brand">品牌:</label>
            <input type="text" class="form-control mx-2 mt-2" id="brand" name="brand">
        </div>
        <div class="form-group">
            <label for="status">邮寄状态:</label>
            <select type="text" class="form-control mx-2 mt-2" id="status" name="status">
                <option></option>
                <option>Number UnMatch</option>
                <option>UPC UnMatch</option>
                <option>UPC and Num UnMatch</option>
                <option>Deleted</option>
                <option>UnConfirmed InStock</option>
                <option>UnConfirmed UnReceived</option>
                <option>UnConfirmed UnPlaced</option>
                <option>InStock</option>
                <option>UnReceived</option>
                <option>Packed</option>
                <option>Delivered</option>
                <option>EmailedLabel</option>
                <option>Shipped</option>
                <option>Complete</option>
            </select>
        </div>
        <div class="form-group">
            <label for="payStatus">支付状态:</label>
            <select type="text" class="form-control mx-2 mt-2" id="payStatus" name="payStatus">
                <option></option>
                <option>Paid</option>
                <option>UnPaid</option>
                <option>Paying</option>
                <option>PartlyPaid</option>
            </select>
        </div>
        <div class="form-group container" >
            <label for="productName" style="margin-left: -30px;">商品名称:</label>
            <input type="text" class="form-control mx-2 mt-2" id="productName" name="productName">
        </div>
        <div class="form-group">
            <label for="quantity">数量:</label>
            <input type="text" class="form-control mx-2 mt-2" id="quantity" name="quantity">
        </div>
        <div class="form-group">
            <label for="price">价格:</label>
            <input type="text" class="form-control mx-2 mt-2" id="price" name="price">
        </div>
        <div class="form-group">
            <label for="sku">SUK:</label>
            <input type="text" class="form-control mx-2 mt-2" id="sku" name="sku">
        </div>
        <div class="form-group">
            <label for="upc">UPC:</label>
            <input type="text" class="form-control mx-2 mt-2" id="upc" name="upc">
        </div>
        <div class="form-group">
            <label for="asin">ASIN:</label>
            <input type="text" class="form-control mx-2 mt-2" id="asin" name="asin">
        </div>
        <div class="form-group">
            <label for="creditCardNumber">信用卡信息:</label>
            <input type="text" class="form-control mx-2 mt-2" id="creditCardNumber" name="creditCardNumber">
        </div>
        <div class="form-group container">
            <label for="optionAddress" style="margin-left: -30px;">选择地址:</label>
            <div id="optionAddress" style="width:30%" class="form-control mx-2 mt-2">
                <div>
                <input type="radio" name="addressCheckbox" onclick="changeToHome()" value="Home"
                       id="address1" checked>&nbsp;&nbsp;&nbsp;
                    <span>Home</span>&emsp;&emsp;
                </div>
                <div>
                    <input type="radio" name="addressCheckbox" onclick="changeToAddress1()" id="address2">&nbsp;&nbsp;&nbsp;
                    <span></span>&emsp;&emsp;
                </div>
                <div >
                    <input type="radio" name="addressCheckbox" onclick="changeToAddress2()" id="address3">&nbsp;&nbsp;&nbsp;
                    <span></span>&emsp;&emsp;
                </div>

                <div >
                    <input type="radio" name="addressCheckbox" onclick="changeToAddress3()" id="address4">&nbsp;&nbsp;&nbsp;
                    <span></span>&emsp;&emsp;
                </div>

            </div>
        </div>
        <div class="form-group container">
            <span id="home" style="display: none;">11</span>
            <label for="address" style="margin-left: -30px;">或填写地址:</label>
            <input type="text" class="form-control mx-2 mt-2" id="address" value="Home" name="address">
        </div>
        <div class="form-group">
            <label for="trackingNumber">Tracking:</label>
            <input type="text" class="form-control mx-2 mt-2" id="trackingNumber" name="trackingNumber">
        </div>
        <div class="form-group">
            <label for="shipID">Ship ID:</label>
            <input type="text" class="form-control mx-2 mt-2" id="shipID" name="shipID">
        </div>
        <div class="form-group">
            <label for="note">Note:</label>
            <input type="text" class="form-control mx-2 mt-2" id="note" name="note">
        </div>
        <div align=center class="container" style="margin-top:22px">
            <input type="reset" name="reset" style="display: none;" />
            <button type="submit"  class="btn btn-primary">Submit</button>
        </div>
    </form>
</div>
</body>
<script type="text/javascript">
    var params ;
    $(document).ready(function () {
        params = getParameters();
        //初始化页面数据
        initPage();
    });

    function initPage() {
        //后台获取数据
        var layerIndex = layer.load(1);
        $.ajax({
            type: 'GET',
            url: "/package/findPackageById",
            data: params,
            async: true,
            success: function (res) {
                console.log(res)
                layer.close(layerIndex);
                if (res.data.state === "000000") {
                    //console.log(res.data);
                    //解析数据
                    pushData(res);
                } else {
                    //业务错误提示
                    // TODO  根据不同错误不同处理
                    swalError(res.message);
                }
            }, error: function (res) {
                layer.close(layerIndex);
                swalSysError(res);
            }
        });

        //地址
        $.ajax({
            type: 'GET',
            url: "/company/getCurrentCompanyClient",
            data: "",
            async: true,
            success: function (res) {
                layer.close(layerIndex);
                if (res.data.state === "000000") {
                    //解析数据
                    if(res.data.data.addressDetail1 != null && res.data.data.addressDetail1 != ""){
                        var label1 = $("#address2").next();
                        label1[0].innerText = res.data.data.addressDetail1;
                    }else{
                        $("#address2").parentElement.css("display","none");
                    }

                    if(res.data.data.addressDetail2 != null && res.data.data.addressDetail2 != ""){
                        var label2 = $("#address3").next();
                        label2[0].innerText = res.data.data.addressDetail2;
                    }else{
                        $("#address3").parent().css("display","none");
                    }

                    if(res.data.data.addressDetail3 != null && res.data.data.addressDetail3 != ""){
                        var label3 = $("#address4").next();
                        label3[0].innerText = res.data.data.addressDetail3;
                    }else{
                        $("#address4").parent().css("display","none");
                    }
                } else {
                    //业务错误提示
                    // TODO  根据不同错误不同处理
                    swalError(res.data.message);
                }
            }, error: function (res) {
                layer.close(layerIndex);
                swalSysError(res);
            }
        });

        //用户
        $.ajax({
            type: 'GET',
            url: "/user/getCurrentUserClient",
            data: "",
            async: true,
            success: function (res) {
                layer.close(layerIndex);
                console.log($("#home"));
                if (res.data.state === "000000") {
                    $("#home").text(res.data.data.address);
                    $("#address").val(res.data.data.address);
                } else {
                    //业务错误提示
                    // TODO  根据不同错误不同处理
                    swalError(res.data.message);
                }
            }, error: function (res) {
                layer.close(layerIndex);
                swalSysError(res);
            }
        });
    }

    function pushData(res) {
        //清空表格
        $("#dataTable tr:not(:first)").empty();
        var data = res.data;
        data = data.data;
        $("#id").val(data.id);
        $("#modelNumber").val(data.modelNumber);
        $("#asin").val(data.asin);
        $("#productName").val(data.productName);
        $("#brand").val(data.brand);
        $("#status").val(data.status);
        $("#payStatus").val(data.payStatus);
        $("#sku").val(data.sku);
        $("#upc").val(data.upc);
        $("#quantity").val(data.quantity);
        $("#weight").val(data.weight);
        $("#length").val(data.length);
        $("#width").val(data.width);
        $("#height").val(data.height);
        $("#price").val(data.price);
        $("#creditCardNumber").val(data.creditCardNumber);
        $("#trackingNumber").val(data.trackingNumber);
        $("#shipID").val(data.shipID);
        $("#note").val(data.note);
    }

    //避免页面上出现 null
    function emptyFormatter(data) {
        if (!data) {
            return ""
        }
        return data;
    }

    //优化页面显示
    function statusFormatter(data) {
        if (!data) {
            return '';
        }
        if (data === 'Complete')
            return '<span class="badge badge-pill badge-success">' + data + '</span>';
        else if (data === 'Deleted')
            return '<span class="badge badge-pill  badge-danger">' + data + '</span>';
        else return '<span class="badge badge-pill  badge-default">' + data + '</span>';
    }

    //优化页面显示
    function moneyFormatter(data) {
        if (!data) {
            return '';
        }
        return data + " $";
    }

    //单个产品进行修改
    function Simple_Update_Product(obj){
        window.location.href="/view/EbizProduct/toEditProductPage?productId="+obj;
    }
</script>
</html>